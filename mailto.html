<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MailTo Generator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="mailto-page">

    <div class="app-container">
        <div class="panel">
            <div class="main-content">
                <div id="app-startup-error" class="hidden app-startup-banner"></div>
                
                <!-- SECTION 1: LIBRARY (Accordion) -->
                <div id="library-section" class="accordion">
                    <div class="accordion-header" id="library-header">
                        <div class="section-header-wrapper" style="margin:0; flex-grow:1;">
                            <h3 class="section-header">Template Library</h3>
                        </div>
                        <div class="button-group" style="margin-right: 10px;">
                             <button id="btn-settings" class="btn-icon" title="Settings" style="padding:2px;">‚öôÔ∏è</button>
                             <button id="btn-new-folder" class="btn-icon" title="New Folder" style="padding:2px;">üìÇ+</button>
                        </div>
                        <span class="accordion-icon">‚ñº</span>
                    </div>
                    
                    <div class="accordion-content">
                        <div id="breadcrumb-container" class="breadcrumb-container"></div>
                        <div id="tree-list-container" class="tree-list-container"></div>
                    </div>
                </div>

                <!-- SECTION 2: EDITOR (Accordion - Default Open) -->
                <div id="editor-section" class="accordion expanded">
                    <div class="accordion-header" id="editor-header">
                        <h3 class="section-header">Editor & Upload</h3>
                        <div style="display:flex; align-items:center; gap:10px;">
                            <button id="btn-clear-all" class="btn btn-danger" style="padding: 2px 8px; font-size: 0.75rem;">Clear All</button>
                            <span class="accordion-icon">‚ñº</span>
                        </div>
                    </div>
                    
                    <div class="accordion-content">
                        <div class="editor-container">
                            <!-- Compact Upload Zone -->
                            <div id="upload-wrapper">
                                <input type="file" id="msg-upload" accept=".msg,.oft,.eml,.email">
                                <div class="upload-label-content">
                                    <!-- Simple Upload Icon -->
                                    <svg aria-hidden="true" width="24" height="24" fill="currentColor" viewBox="0 0 16 16"><path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/><path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/></svg>
                                    <div style="display:flex; flex-direction:column;">
                                        <strong>Drop Email File</strong>
                                        <span style="font-size:0.8em">.msg, .eml, .oft</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Input Fields -->
                            <div class="form-group">
                                <input type="text" id="result-to" class="form-control" placeholder="To">
                            </div>
                            <div class="grid-2-tight">
                                <div class="form-group">
                                    <input type="text" id="result-cc" class="form-control" placeholder="CC">
                                </div>
                                <div class="form-group">
                                    <input type="text" id="result-bcc" class="form-control" placeholder="BCC">
                                </div>
                            </div>
                            <div class="form-group">
                                <input type="text" id="result-subject" class="form-control" placeholder="Subject">
                            </div>
                            
                            <!-- Growing Body Field -->
                            <div class="form-group body-group">
                                <textarea id="result-body" class="form-control body-input" placeholder="Body content..."></textarea>
                            </div>
                            
                            <!-- Hidden Fields for Save Logic (Now handled in Modal, but placeholders kept in state) -->
                            <div class="hidden">
                                <input type="text" id="save-template-name">
                                <select id="save-target-folder"></select>
                            </div>

                            <!-- Live Output & Actions -->
                            <div id="output-wrapper" style="margin-top:1rem; border-top: 1px solid var(--border-color); padding-top: 1rem;">
                                <div class="form-group">
                                    <label>Live Link Preview</label>
                                    <div style="display:flex; gap:5px;">
                                        <input type="text" id="result-mailto" class="form-control" readonly placeholder="mailto:...">
                                        <button id="copy-mailto-btn" class="btn">Copy</button>
                                    </div>
                                </div>

                                <div class="grid-2">
                                    <button id="btn-save-to-library" class="btn btn-success">Save Template</button>
                                    <a href="#" id="result-link" target="_blank" rel="noopener noreferrer" class="btn btn-primary" style="width:100%; text-align:center;">Open in Client</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="modal-overlay" class="modal-overlay">
        <div id="modal-content" class="modal-content"></div>
    </div>
    <div id="toast" class="toast"></div>

    <!--
      CRITICAL: Bootstrap script must be at the END of the body.
      It loads the Navbar HTML and all JS dependencies in parallel.
    -->
    <script src="js/bootstrap.js"></script>
</body>
</html>
